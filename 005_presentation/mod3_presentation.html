<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Advances in the analysis of multivariate ecological data</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jonathan Jupke" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs\sydney.css" type="text/css" />
    <link rel="stylesheet" href="libs\sydney-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Advances in the analysis of multivariate ecological data
## MOD3: Advanced data science
### Jonathan Jupke
### University of Koblenz Landau
### 2021/01/07

---

&lt;style type="text/css"&gt;
.remark-code { font-family: 'Source Code Pro', 'Lucida Console', Monaco, monospace;
                                    font-size: 100%;
                                  }
}
&lt;/style&gt;






&lt;!--TODO abstand zwischen Bullets--&gt;  
&lt;!--# TODO serial slide--&gt;   
&lt;!--# TODO bullet color--&gt;  

# Plan for today 

- What’s new in multivariate analysis?

- mvabund

- Vector GLM/GAM

- Latent Variable Models 

- Copulas 

- Hierarchical Modeling of Species Communities

- Neural Hierarchical Models 


---
class: inverse, center, middle 

# What’s new in multivariate analysis?

---

# ... or what's old

--

brainstrom : What Methods do you know? 

--

- PCA
- RDA
- PERMANOVA
- CA/ CCA
- Random Forests 
- Clustering Methods 

---
# Bi/Triplot


```r
library(vegan)
data(dune)
data(dune.env)
rda_object &lt;- rda(dune ~ ., dune.env)
```

---
# Bi/Triplot

```r
plot(rda_object)
```

&lt;img src="mod3_presentation_files/figure-html/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /&gt;

---
# What do most ordinations have in common? 

--

They are based on some notion of a distance metric

##fixed 
- PCA and RDA: Euclidean 
- CA and CCA: `\(\chi^2\)`-distance

--

##flexible 
- NMDS 
- PCoA
- dbRDA

---
# How does that differ from the univerate and why? 

--

In univariate analyses we mostly use models:
- linear model 
- linear mixed model 
- generalized linear model 
- generalized additive models 

--

`\(\rightarrow\)` why not in multivariate analyses? 

---
class: middle, center

&lt;img src="old_pc.gif" style="display: block; margin: auto;" /&gt;

---
# The idea is old 

The Gaussian response model: 
$$Y_i = ce^{- \frac{(X_i - u)^2}{2t^2}} $$
--
Can be rewritten as a GLM:
`$$Y_i = exp(ln(c) - \frac{u^2}{2t^2} + \frac{u}{t^2}x_i - \frac{1}{2t^2}x^2_i) = exp(b_1 + b_2 x_i + b_3 x_i^2)$$`
--
with 
$$ t = \frac{1}{\sqrt{-2b_3}}; u = \frac{-b_2}{2b_3}; c =     exp(b_1 - \frac{b_2^2}{4b_3})$$ 
--
For M species and Q environmental variables we would need: `\((1+2Q)M\)` parameters. For 10 species and 5 variables 110 parameters.  

---
# Restricted Gaussian Regression 

gradients as linear combinations of measured variables: 

`$$z_i = \Sigma_{p =  1}^Q \alpha_p x_{ip}$$`
--
Plug gradients back into Gaussian regression
`$$Y_i = ce ^{\frac{(z_i - u)^2}{2t^2}}$$` 

Depending on the number of gradients this reduces the number of parameters. 

---
# What is the model-based approach? 

Model-based approaches assume a parametric generative model

Terms are not consistent:  
Roberts (2019) vs. Warton *el al.* (2012) dissagree about wether CA is distance-based

Alternative: algorithm-based (Warton *et al.* 2015) 
Alternative 2: transformation-based  

"*Our constrained ordination model [...]* " Brittain *et al.* (2020)  
"*Many biologist fit CCA models [...]* " Yee (2004) 

---
background-image: url("figures/glm_error.png")
background-size: 500px
background-position: 50% 50%
&lt;!-- Are models better  1--&gt;
# Are models better? 

---
background-image: url("figures/WWW12_1.png")
background-size: 800px
background-position: 50% 50%
&lt;!-- Are models better  2--&gt;
# Are models better? 

Every distance metric assumes a mean variance relationship  

.footnote[Warton *et al.* (2012)]
---
background-image: url("figures/WWW12_2.png")
background-size: 400px
background-position: 50% 75%

# Are models better? 

Every distance metric assumes a mean variance relationship  

.footnote[Warton *et al.* (2012)]
---
background-image: url("figures/WWW12_3.png")
background-size: 400px
background-position: 50% 75%

# Are models better? 

Every distance metric assumes a mean variance relationship  



.footnote[Warton *et al.* (2012)]
---
background-image: url("figures/szöcs15_1.png")
background-size: 400px
background-position: 50% 75%

# Are models better? 



.footnote[Szöcs *et al.* (2015)]
---
background-image: url("figures/jupke20_1.png")
background-size: 800px
background-position: 50% 50%

# Are models better? 

.footnote[Jupke *et al.* (2020)]
---
class: inverse, center, middle 

# mvabund

---
# mvabund 

R package published in 2012  (Wang et al. 2012)

**M**ulti**v**ariate **Abund**ance data  

Multivariate
- many, possibly correlated responses 

Abundance
- strong mean-variance relationship 
---
# Multivariate GLMM

We could use mixed models and model the taxon as a random effect.
`$$Abundace \sim species\ + variable1\ + variable2\ + (0 + species|sample)$$`
1. `\(y_{ij}\)` are independand, conditional on mean  `\(\mu_{ij}\)`
2. Conditional on `\(\mu_{ij}\)`, data come from a .blue[known distribution]  
3. straight line relationship between some function `\(\mu_{ij}\)` and x, with error `\(\epsilon_{ij}\)`
`$$g(\mu_{ij}) = \beta_0j + x^T_j \beta_j + \epsilon_{ij}$$`
4. `\(\epsilon\)` are normally distributed. They introduce correlation between response within observatios. 
`$$\epsilon_{ij} \sim MVN(0, \Sigma)$$`
---
# Implementations in R

- lme4 
- MCMCglmm 
- Purpose written code (e.g. Pollock et al 2014)

---
# Whats the problem with this approach? 

|  # responses | # parameters in `\(\Sigma\)` |
| :---- |:--- |
| 5     | 15 |
| 10    | 55 |
| 20    | 210 |
| 40    |  820 |

- No convergence in ML GLMM  
- long run time, not all parameters converge, and big influence of prior as `\(\frac{\# data}{\#parameters}\)` is small. 
  
---
# Simplify
mvabund uses design-based inference and assumes simple correlation structures.  
This is fine if we are primarily interested in species environment relationships  

--
Multivariate: row resampling for inference, preserves species correlations  
Abundance: separate GLM for each species
---
# Test statistics  

default: `\(\Sigma\ Likelihood\ Ratios\)`
`\begin{align}
L &amp; = 2 \times (l_M - l_m)  \\
L &amp;\sim \chi^2_{p_M - p_m} \\  
\end{align}`

This does not account for correlations in the statistic but in the pseudo-*p*-value.  
--
  
  
Alternatives:      
  
Wald statistic   
`\begin{align}
W &amp;= \frac{(\beta_m - \beta_0)^2}{var(\beta_m)} \\
z &amp;= \sqrt(W)
\end{align}`

Score statistic  
see e.g. Dunn \&amp; Smyth (2018)

---
# Correlation options
  
.blue["I"]: No correlation, default setting   
.blue["R"]: Assumes correlation, cf. mixed model  
.blue["shrink"]: middle option, shrinks correlation matrix to `\(I\)` with ridge regularization (Warton (2008))  
  
For R and shrink LR is not available. They are estimated with generalized estimation equations (Warton 2011) which do not produce likelihoods. 

---


```r
library(mvabund)
data("Tasmania")
attach(Tasmania)
head(copepods[,1:3])
```

```
##      Ameira Adopsyllus Ectinosoma
## B1D1     43          0          0
## B1D2     63          0          0
## B1U1    124          0          0
## B1U2    105          0          2
## B2D1      4          0          0
## B2D2      5          0          0
```

```r
tasmvabund &lt;- mvabund(copepods)
class(tasmvabund)
```

```
## [1] "mvabund" "matrix"
```
---

```r
plot(tasmvabund~treatment, col = as.numeric(block))
```

```
## 
##  PIPING TO 2nd MVFACTOR
```

&lt;img src="mod3_presentation_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;
---

```r
meanvar.plot(copepods~tr.block, col = as.numeric (treatment))
```

```
## START SECTION 2 
## Plotting if overlay is TRUE
```

&lt;img src="mod3_presentation_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

```
## FINISHED SECTION 2
```
---
# Fitting a model 

```r
tas.nb &lt;- manyglm(copepods ~ block*treatment, 
                  family = "negative.binomial")
```


`$$Y_{ij} \sim NB(\mu_{jkl}, \phi_j)$$`
`$$log(\mu_{jkl}) = intercept_j + block_{jkl} + treatment_{jl} + block \times treatment_{jkl}$$`
---
# Checking model assumptions 

```r
plot.manyglm(tas.nb, which = 1)
```

&lt;img src="mod3_presentation_files/figure-html/mvabund Checking model assumptions 1-1.png" style="display: block; margin: auto;" /&gt;
.footnote[Dunn &amp; Smyth (1996)]
---
# Checking model assumptions

```r
plot.manyglm(tas.nb, which = 2)
```

&lt;img src="mod3_presentation_files/figure-html/mvabund Checking model assumptions 2-1.png" style="display: block; margin: auto;" /&gt;
.footnote[Dunn &amp; Smyth (1996)]
---
# Checking model assumptions

```r
plot.manyglm(tas.nb, which = 3)
```

&lt;img src="mod3_presentation_files/figure-html/mvabund Checking model assumptions 3-1.png" style="display: block; margin: auto;" /&gt;
.footnote[Dunn &amp; Smyth (1996)]
---
# Testing Hypotheses


```r
# anova_out &lt;- anova(tas.nb, p.uni = "adjusted")
```
.scroll-box-16[

```r
# anova_out
```
]
---

```r
library(lattice)
a &lt;- max(abs(coef(tas.nb)))
colort &lt;- colorRampPalette(c("blue", "white", "red"))
plot.tas &lt;- levelplot(t(as.matrix(coef(tas.nb))), ylab = "", xlab  = "", col.regions = colort(100), at=seq(-a,a,length = 100), scales = list( x= list(rot = 45)))
print(plot.tas)
```

![](mod3_presentation_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;
---

```r
tas_pred = predict(tas.nb, type = "response")
matplot(t(tas_pred[c(1,3),]), type = "l", xaxt = "n", log = "y", ylab = "Mean abundance [log]")
axis(1, at =1:12, labels = colnames(copepods), las = 3)
legend("topright", legend = levels(treatment), col = 1:2, lty = 1:2)
```

![](mod3_presentation_files/figure-html/unnamed-chunk-11-1.png)&lt;!-- --&gt;


---
# Traits 
Not discussed in lecture. See here for introduction:  
https://rpubs.com/dwarton/68823

---
class: inverse, center, middle 

# Vector Genralized Models 
---
# VGLMs
.footnote[see Dobson &amp; Barnett (2018) for more on the exponential family]

... are an extension of GLMs   
GLMs are restricted to distributions from the .blue[exponential family].   
VGLMS are not.  
VGLMs can have multiple linear predictors, for different parameters.  
Explanatroy variables can differ between predictors.
---
# The exponential family

`$$f(x, \theta) = s(x)\ t(\theta)\ exp (a(y)\ b(\theta))$$`
--
$$f(x, \theta) = exp(a(y)\ b(\theta) + c(\theta) + d(y)) $$
with `\(c(\theta) = exp(t(\theta))\)` and `\(d(y) = exp(s(y))\)`

--

.blue[Poisson]
`\begin{align}
f(x,\lambda) &amp;= \frac{\lambda^y e^{-\lambda}}{y!}\\
\theta &amp;= \lambda\\
f(x, \theta) &amp;= exp(log(\theta)\ y - \theta - log(y!))
\end{align}`


---
# Reduced Rank VGLM  

Reduce the dimensions, i.e. number of predictors `\(P\)` by reduced rank regression   

--

Create latent variables `\(\nu\)` from subset of environmental variables `\(X\)`

--

`\(x = (x_1, x_2)\)` and `\(B = c(B_1,B_2)\)`  

--
`$$B_2 = A C^T$$` 
`$$\nu = C^T x_2\ \ \ \ \ \ (site\ scores)$$`
`$$\eta = B_1^T x_1 + A C^Tx_2 = B_1^T x_1 + A \nu$$`
--
`\(\rightarrow\)` Reduced Rank Regression is the same as RDA! 


---

# Quadratic RR-VGLM

In ecology, unimodal responses are the norm (Oksanen &amp; Minchin, 2002)  

--

quadratic linear predictor  

--

`$$\eta = B_1^T x_1 + A C^Tx_2 = B_1^T x_1 + A \nu\ \ \ \ \ \ \ ordinary\ RR-VGLM$$`
`$$\eta_s = \beta_{1(s)}^T  + \beta_{2(s)}\ \nu + \beta_{3(s)}\ \nu^2\ \ \ \ \ \ \ quadratic\ RR-VGLM$$`
$$ log\ \mu_s(\nu) = \eta_s = \alpha_s - \frac{1}{2} \bigg( \frac{\nu - u_s}{t_s} \bigg)^2 $$


---
# Hunting Spider Data

from ter Braak (1986)  



&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:700px; "&gt;&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; WaterCon &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; BareSand &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; FallTwig &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; CoveMoss &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; CoveHerb &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ReflLux &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopacce &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopcune &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Alopfabr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Arctlute &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Arctperi &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Auloalbi &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardlugu &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardmont &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardnigr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Pardpull &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Trocterr &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Zoraspin &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.3321 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.4543 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9120 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0493 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.5572 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6052 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6741 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.9957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 94 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 86 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0155 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 135 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 91 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.3810 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1781 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 89 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 105 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 118 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6247 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.2627 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.4849 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3307 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.1972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9318 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.2192 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.1109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.7136 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.2925 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.8286 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.5175 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 43 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0865 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 94 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.2696 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0301 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.6052 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.3322 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.4543 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1224 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.9232 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6094 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.1091 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.9755 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.2528 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3307 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9120 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.1939 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0943 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.6487 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2581 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.0073 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1.8245 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.5835 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0986 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.1109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9933 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7918 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3820 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9555 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3979 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.8286 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9555 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.7136 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.4340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6889 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;
---
# Rank-1 Poisson CQO
.scroll-output[

```r
set.seed(1234)
hspider[, 1:6] &lt;- scale(hspider[, 1:6]) # Standardized environmental variables
p1ut.hs &lt;- cqo(cbind(Alopacce, Alopcune, Alopfabr, 
                     Arctlute, Arctperi, Auloalbi, 
                     Pardlugu, Pardmont, Pardnigr, 
                     Pardpull, Trocterr, Zoraspin) ~ 
                 WaterCon + BareSand + FallTwig + CoveMoss + 
                 CoveHerb + ReflLux,
               family = poissonff, 
               data = hspider, 
               eq.toler = FALSE, 
               trace = FALSE)
```

```
## cqo_1; no convergence for Species number   4. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
## cqo_1; no convergence for Species number   5. Trying internal starting values.
```
]


---
# Latent Variable Plot 

```r
lvplot(p1ut.hs, y = TRUE, lcol = clr, pch = 1:S, pcol = clr)
```

&lt;img src="mod3_presentation_files/figure-html/cqo lvplot 1-1.png" style="display: block; margin: auto;" /&gt;

---
# 2d Perspective Plot 

```r
persp(p1ut.hs, col = clr, label = TRUE) # Perspective plot
```

&lt;img src="mod3_presentation_files/figure-html/CQO persp plot-1.png" style="display: block; margin: auto;" /&gt;

---
# Constrained Coefficients

```r
concoef(p1ut.hs) %&gt;%  as.vector() %&gt;% round(2) -&gt; p1ut_coef
names(p1ut_coef) &lt;- row.names(concoef(p1ut.hs))
print(p1ut_coef)
```

```
## WaterCon BareSand FallTwig CoveMoss CoveHerb  ReflLux 
##     0.23    -0.51     0.60    -0.21     0.34    -0.80
```

--
.scroll-box-8[

```r
Tol(p1ut.hs)[1, 1, ]
```

```
##   Alopacce   Alopcune   Alopfabr   Arctlute   Arctperi   Auloalbi   Pardlugu 
##  1.0000000  0.7215282  1.0990803  0.2244719  0.7099974  0.5174699 -2.4202413 
##   Pardmont   Pardnigr   Pardpull   Trocterr   Zoraspin 
##  0.8943600  0.2799506  0.3561246  0.8697751  0.5020176
```
]
---
# Let's add a second gradient
.small[

```r
p2et.hs &lt;- cqo(cbind(Alopacce, Alopcune, Alopfabr, Arctlute, Arctperi,Auloalbi, Pardlugu, Pardmont, Pardnigr, ... = Pardpull,Trocterr, Zoraspin)
               ~ WaterCon + BareSand + FallTwig + CoveMoss + CoveHerb + ReflLux,
               poissonff, data = hspider, Crow1positive = FALSE, Rank = 2,
               I.toler = TRUE, Bestof = 2)
```

```
## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3

## Warning in fn(par, ...): error code in callcqoc = 3
```
]
---
# 2 Graident Latent Variable Plot 

&lt;img src="mod3_presentation_files/figure-html/2d latent variable plot-1.png" style="display: block; margin: auto;" /&gt;

---
# 3d Perspective plot

```r
persp(p2et.hs, xlim = c(-6, 5), ylim = c(-6, 3), 
      theta = 120, phi = 20)
```

&lt;img src="mod3_presentation_files/figure-html/CQO 2d persp plot-1.png" style="display: block; margin: auto;" /&gt;
---
# Extended ouput 

.scroll-output[

```r
coef(p2et.hs)
```

```
## 
## C matrix (constrained/canonical coefficients)
##             latvar1    latvar2
## WaterCon -0.3055434 -1.2743724
## BareSand  0.4548566  0.1572668
## FallTwig -0.6424939  0.6072466
## CoveMoss  0.4604092 -0.9255322
## CoveHerb -0.4161826 -0.2036919
## ReflLux   1.0748765  0.0502115
## 
## B1 and A matrices
##                      (Intercept)  A.latvar1   A.latvar2
## loglink(E[Alopacce])  2.34918693  1.7505368  0.28385372
## loglink(E[Alopcune])  3.65052960 -0.2262756  0.04103486
## loglink(E[Alopfabr]) -0.87127005  2.6470499  1.02426251
## loglink(E[Arctlute]) -0.03853201 -1.0361967 -1.51611184
## loglink(E[Arctperi]) -7.82840869  4.1201710  2.13224139
## loglink(E[Auloalbi])  2.92971635 -0.6263280 -0.38753106
## loglink(E[Pardlugu])  1.30355616 -1.4744618  1.85150297
## loglink(E[Pardmont])  3.58447870  1.0644544 -0.75020248
## loglink(E[Pardnigr])  4.13542367 -0.6205682 -0.30342210
## loglink(E[...])       3.75270854 -0.5391683 -1.22562234
## loglink(E[Trocterr])  5.10923423 -0.7068856 -0.02138793
## loglink(E[Zoraspin])  2.60636351 -1.0289971 -0.74939839
## 
## Optimums and maximums
##          Optimum.latvar1 Optimum.latvar2    Maximum
## Alopacce       1.7505368      0.28385372  50.484324
## Alopcune      -0.2262756      0.04103486  39.526520
## Alopfabr       2.6470499      1.02426251  23.493488
## Arctlute      -1.0361967     -1.51611184   5.194588
## Arctperi       4.1201710      2.13224139  18.778687
## Auloalbi      -0.6263280     -0.38753106  24.555845
## Pardlugu      -1.4744618      1.85150297  60.618893
## Pardmont       1.0644544     -0.75020248  84.134118
## Pardnigr      -0.6205682     -0.30342210  79.361122
## ...           -0.5391683     -1.22562234 104.494544
## Trocterr      -0.7068856     -0.02138793 212.577495
## Zoraspin      -1.0289971     -0.74939839  30.465047
## 
## Tolerances
##          tol1 tol2
## Alopacce    1    1
## Alopcune    1    1
## Alopfabr    1    1
## Arctlute    1    1
## Arctperi    1    1
## Auloalbi    1    1
## Pardlugu    1    1
## Pardmont    1    1
## Pardnigr    1    1
## ...         1    1
## Trocterr    1    1
## Zoraspin    1    1
## 
## Standard deviation of the latent variables (site scores)
##  latvar1  latvar2 
## 2.471191 1.155067
```

]
---
# Constained Additive Ordination 
Besides VGLMs, additive models VGAMs can be fitted.  
- Syntax similar to CQO 
- new argument: *df1.nl*: effective non-linear degrees of freedom  
- controls how smooth the output is (0 = linear)
.scroll-output[

```r
set.seed(1)
# p1cao.hs &lt;- cao(cbind(Alopacce, Alopcune, Alopfabr, Arctlute, Arctperi, Auloalbi,
#                       Pardlugu, Pardmont, Pardnigr, Pardpull, Trocterr, Zoraspin) ~
#                 WaterCon + BareSand + FallTwig + CoveMoss + CoveHerb + ReflLux,
#                 poissonff, data = hspider, Rank = 1, df1.nl = 2, Bestof = 10, 
#                 Crow1positive = FALSE)
```

]
---
# CAO single species plots


---

---
# In practice 

- They are not commonly used 
- individual GLMs outperformed CQO in predicting species ranges (Baselga &amp; Araújo, 2009)
- CQO better for rare species but GLM predicts better (Bonthoux *et al.* 2013) 
- mvabund glms differentiated between noise and causal variables better than CQO (Jupke &amp; Schäfer, 2020)
- CQO and CAO predict better (but still bad) than GLM and GAM to dissimilar conditions (Maguire *et. al.*, 2016) 
- Applied studies mostly with fish (e.g. Vilizzi et al. (2012), Top *et al.* (2016))
- "limitations on the number of species, steepness of the learning curve and low numerical stability of the algorithm" (ter Braak &amp; Šmilauer 2015)
---
class: inverse, center, middle
# Latent Variable Models 
---

# Think back to GLMM 

`\begin{align}
g(m_{ij}) &amp;= \alpha_i + \beta_{0i} + x_j^T \beta_i + u_{ij}\\
y_{ij}|u_{ij} &amp;\sim F(m_{ij}, \phi)\\
u_i &amp; \sim N(0, \Sigma)
\end{align}`

--

--- 
`\begin{align}
g(m_{ij}) &amp;= \alpha_i + \beta_{0i} + x_j^T \beta_i + u_{ij}\\
u_i &amp;= z_i^T \lambda_j\\
y_{ij}|z_{i} &amp;\sim F(m_{ij}, \phi)\\
z_{i} &amp;\sim N(0, I)
\end{align}`

--
`\(\rightarrow\)` basically an ordination of the covariance matrix
---

```r
library(gllvm);library(corrplot);library(gclus)
```

```
## Loading required package: TMB
```

```
## 
## Attaching package: 'gllvm'
```

```
## The following object is masked from 'package:VGAM':
## 
##     predict
```

```
## The following object is masked from 'package:mvabund':
## 
##     coefplot
```

```
## The following object is masked from 'package:vegan':
## 
##     ordiplot
```

```
## The following objects are masked from 'package:stats':
## 
##     predict, simulate
```

```
## corrplot 0.84 loaded
```

```
## Loading required package: cluster
```

```
## Registered S3 method overwritten by 'gclus':
##   method         from 
##   reorder.hclust vegan
```

```r
data("antTraits")
y &lt;- as.matrix(antTraits$abund)
X &lt;- scale(as.matrix(antTraits$env))
TR &lt;- antTraits$traits
```
---
# Unconstrained ordination with gllvm
.scroll-output[

```r
fit_uo_po &lt;- gllvm(y, family = poisson())
fit_uo_nb &lt;- gllvm(y, family = "negative.binomial")
fit_uo_po
```

```
## Call: 
## gllvm(y = y, family = poisson())
## family: 
## [1] "poisson"
## method: 
## [1] "VA"
## 
## log-likelihood:  -2128.631 
## Residual degrees of freedom:  1108 
## AIC:  4501.262 
## AICc:  4178.552 
## BIC:  4672.208
```

```r
fit_uo_nb
```

```
## Call: 
## gllvm(y = y, family = "negative.binomial")
## family: 
## [1] "negative.binomial"
## method: 
## [1] "VA"
## 
## log-likelihood:  -1895.085 
## Residual degrees of freedom:  1067 
## AIC:  4116.171 
## AICc:  3717.186 
## BIC:  4344.566
```

```r
par(mfrow = c(1,2))
plot(fit_uo_nb, which = 1)
plot(fit_uo_po, which = 1)
```

![](mod3_presentation_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;

```r
plot(fit_uo_nb, which = 2)
plot(fit_uo_po, which = 2)
```

![](mod3_presentation_files/figure-html/unnamed-chunk-14-2.png)&lt;!-- --&gt;

```r
plot(fit_uo_nb, which = 3)
plot(fit_uo_po, which = 3)
```

![](mod3_presentation_files/figure-html/unnamed-chunk-14-3.png)&lt;!-- --&gt;
]
---
# Biplot with gllvm 

&lt;img src="mod3_presentation_files/figure-html/gllvm unconstrained biplot-1.png" style="display: block; margin: auto;" /&gt;
---
# Constrained Ordination with gllvm 

```r
fit_co_nb2 &lt;- gllvm(y, X, num.lv = 2, 
                    formula = ~ Bare.ground + Shrub.cover + Volume.lying.CWD, 
                    family = "negative.binomial")
fit_co_nb3 &lt;- gllvm(y, X, num.lv = 3, 
                    formula = ~ Bare.ground + Shrub.cover + Volume.lying.CWD, 
                    family = "negative.binomial")
```
---
# Biplot of constrained ordination 
&lt;img src="mod3_presentation_files/figure-html/gllvm constrained biplot-1.png" style="display: block; margin: auto;" /&gt;
---
# Coefficient plot 
&lt;img src="mod3_presentation_files/figure-html/gllvm constrained coefficient plot-1.png" style="display: block; margin: auto;" /&gt;
---
# Residual Correlation plot 
&lt;img src="mod3_presentation_files/figure-html/gllvm Residual Correlation plot-1.png" style="display: block; margin: auto;" /&gt;
---
# Fitting a Fourth Corner Model

```r
fit_4th &lt;- gllvm(y, X, TR, 
                 family = "negative.binomial", 
                 num.lv = 2, 
                 formula = y ~ 
                   (Bare.ground + Shrub.cover + Volume.lying.CWD) +
                   (Bare.ground + Shrub.cover + Volume.lying.CWD) :  
                   (Pilosity + Polymorphism + Webers.length))
```
---
# Fourth Corner Interaction Plot
&lt;img src="mod3_presentation_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;
---
# Do Traits matter here? 

```r
fit_4th2 &lt;- gllvm(y, X, TR, family = "negative.binomial", num.lv = 2, 
                  formula = y ~ (Bare.ground + Shrub.cover + Volume.lying.CWD))
anova(fit_4th, fit_4th2)
```

```
## Model  1 :  y ~ (Bare.ground + Shrub.cover + Volume.lying.CWD) 
## Model  2 :  y ~ (Bare.ground + Shrub.cover + Volume.lying.CWD) + (Bare.ground + Shrub.cover + Volume.lying.CWD):(Pilosity + Polymorphism + Webers.length)
```

```
##   Resid.Df        D Df.diff   P.value
## 1     1064  0.00000       0          
## 2     1046 28.64264      18 0.0529252
```
---

class: inverse, center, middle 


# Copulas 

---
class: inverse, center, middle 

# Hierarchical modeling of species communities 

---
class: inverse, center, middle 

# Hierarchical Neural networks 

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
